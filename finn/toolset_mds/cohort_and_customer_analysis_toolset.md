Cohort & Customer Analytics
- **COHORT_ANALYSIS**
  - Purpose: Create cohort retention/revenue tables
  - Input: DataFrame with customer_id, order_date, cohort_period, value
  - Output: DataFrame with cohort metrics
  - Example: COHORT_ANALYSIS(transactions_df, 'customer_id', 'order_date', 'revenue')
- **RETENTION_RATE**
  - Purpose: Calculate customer retention rates by period
  - Input: DataFrame with customer activity by period
  - Output: Series/DataFrame with retention percentages
  - Example: RETENTION_RATE(customer_activity_df, 'month', 'active')
- **CHURN_RATE**
  - Purpose: Calculate customer churn rates
  - Input: DataFrame with customer status by period
  - Output: Float or Series
  - Example: CHURN_RATE(customer_status_df, 'churned_flag')
- **LTV_CALCULATION**
  - Purpose: Calculate Customer Lifetime Value
  - Input: Average revenue per user, churn rate, profit margin
  - Output: Float
  - Example: LTV_CALCULATION(arpu=50, churn_rate=0.05, profit_margin=0.3)
- **PAYBACK_PERIOD**
  - Purpose: Calculate when cumulative profit equals initial investment
  - Input: Series of cash flows, initial investment
  - Output: Integer (period number) or None
  - Example: PAYBACK_PERIOD([-1000, 300, 400, 500], 1000)
- **ASSIGN_COHORT**
  - Purpose: Assign a cohort identifier (e.g., acquisition month/year) to each customer based on their first transaction or sign-up date
  - Input: df (DataFrame), customer_id_col (str), date_col (str), cohort_period (str, e.g., 'M' for month, 'Q' for quarter)
  - Output: DataFrame (with a new 'cohort' column)
  - Example: ASSIGN_COHORT(df, 'customer_id', 'signup_date', 'M')
- **ARPU**
  - Purpose: Calculate the average revenue generated per user or account over a specific period
  - Input: total_revenue (float), total_users (int)
  - Output: Float
  - Example: ARPU(total_revenue=100000, total_users=500)